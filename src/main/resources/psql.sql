drop table if exists employee;
create table employee(
id int primary key GENERATED BY DEFAULT AS IDENTITY,
first_name varchar(45) default null,
last_name varchar(45) default null,
email varchar(45) default null
);

insert into employee values
(1,'David','Adam','david@luv2code.com'),
(2,'John','Doe','john@luv2code.com'),
(3,'Ajay','Rao','ajay@luv2code.com'),
(4,'Mary','Public','mary@luv2code.com'),
(5,'Maxwell','Dixon','max@luv2code.com');

DROP TABLE IF EXISTS customer;
create table customer(
id int primary key GENERATED BY DEFAULT AS IDENTITY,
first_name varchar(45) default null ,
last_name varchar(45) default null,
email varchar(45) default null
);

insert into customer values
(1,'David','Adam','david@luv2code.com'),
(2,'John','Doe','john@luv2code.com'),
(3,'Ajay','Rao','ajay@luv2code.com'),
(4,'Mary','Public','mary@luv2code.com'),
(5,'Maxwell','Dixon','max@luv2code.com');

drop table if exists users;
create table users(
username varchar(50) primary key not null,
password varchar(70)not null,
enabled smallint not null
);

insert into users values
('john','{bcrypt}$2a$12$PUir2k5uUQr6XIh5Q5/jE.XuLY372rmJArnkUAltaONBovXzRimaK',1),
('mary','{bcrypt}$2a$12$PUir2k5uUQr6XIh5Q5/jE.XuLY372rmJArnkUAltaONBovXzRimaK',1),
('susan','{bcrypt}$2a$12$PUir2k5uUQr6XIh5Q5/jE.XuLY372rmJArnkUAltaONBovXzRimaK',1);

drop table if exists authorities;
create table authorities(
username varchar(50) not null,
authority varchar(50)not null,
UNIQUE (username, authority),
 FOREIGN KEY(username) 
	  REFERENCES users(username)
)

insert into authorities values
('john','ROLE_EMPLOYEE'),
('mary','ROLE_EMPLOYEE'),
('mary','ROLE_MANAGER'),
('susan','ROLE_EMPLOYEE'),
('susan','ROLE_MANAGER'),
('susan','ROLE_ADMIN');

drop table if exists members;
create table members(
user_id varchar(50) primary key not null,
pw varchar(70)not null,
active smallint not null
);

insert into members values
('john','{bcrypt}$2a$12$PUir2k5uUQr6XIh5Q5/jE.XuLY372rmJArnkUAltaONBovXzRimaK',1),
('mary','{bcrypt}$2a$12$PUir2k5uUQr6XIh5Q5/jE.XuLY372rmJArnkUAltaONBovXzRimaK',1),
('susan','{bcrypt}$2a$12$PUir2k5uUQr6XIh5Q5/jE.XuLY372rmJArnkUAltaONBovXzRimaK',1);

drop table if exists roles;
create table roles(
user_id varchar(50) not null,
role varchar(50)not null,
UNIQUE (user_id, role),
 FOREIGN KEY(user_id) 
	  REFERENCES members(user_id)
)

insert into roles values
('john','ROLE_EMPLOYEE'),
('mary','ROLE_EMPLOYEE'),
('mary','ROLE_MANAGER'),
('susan','ROLE_EMPLOYEE'),
('susan','ROLE_MANAGER'),
('susan','ROLE_ADMIN');



DROP TABLE IF EXISTS "user";
create table "user"(
id int primary key GENERATED BY DEFAULT AS IDENTITY,
username varchar(50) NOT NULL,
password char(80) NOT NULL,
first_name varchar(50) NOT NULL,
last_name varchar(50) NOT NULL,
email varchar(50) NOT NULL
);


INSERT INTO "user" (username,password,first_name,last_name,email) VALUES 
('john','{bcrypt}$2a$04$eFytJDGtjbThXa80FyOOBuFdK2IwjyWefYkMpiBEFlpBwDH.5PM0K','John','Doe','john@luv2code.com'),
('mary','{bcrypt}$2a$04$eFytJDGtjbThXa80FyOOBuFdK2IwjyWefYkMpiBEFlpBwDH.5PM0K','Mary','Public','mary@luv2code.com'),
('susan','{bcrypt}$2a$04$eFytJDGtjbThXa80FyOOBuFdK2IwjyWefYkMpiBEFlpBwDH.5PM0K','Susan','Adams','susan@luv2code.com');


DROP TABLE IF EXISTS role;

CREATE TABLE role(
 id int primary key GENERATED BY DEFAULT AS IDENTITY,
 name varchar(50) DEFAULT NULL
);

INSERT INTO role(name) VALUES 
('ROLE_EMPLOYEE'),('ROLE_MANAGER'),('ROLE_ADMIN');

DROP TABLE IF EXISTS users_roles;

CREATE TABLE users_roles (
user_id int NOT NULL,
role_id int NOT NULL,
 PRIMARY KEY (user_id,role_id),
 FOREIGN KEY(user_id) 
	  REFERENCES "user"(id),
FOREIGN KEY(role_id) 
	  REFERENCES role(id));
	  
INSERT INTO users_roles (user_id,role_id) VALUES 
(1, 1),
(2, 1),
(2, 2),
(3, 1),
(3, 2),
(3, 3);

select u1_0.id,u1_0.email,u1_0.first_name,u1_0.last_name,u1_0.password,u1_0.username from "user" u1_0 where u1_0.password='test123'

